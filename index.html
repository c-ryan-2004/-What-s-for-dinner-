<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <!-- === SEO å„ªåŒ–å€å¡Š (ç¢ºèªä½ç½®æ­£ç¢º âœ…) === -->
    <title>æ™šé¤åƒä»€éº¼ | é¸æ“‡å›°é›£æ•‘æ˜Ÿ</title>
    <meta name="description" content="æ™šé¤åƒä»€éº¼ï¼Ÿå…¨å°æœ€å¼·æ™šé¤é¸æ“‡å™¨ï¼è§£æ±ºä½ çš„é¸æ“‡å›°é›£ç—‡ã€‚ä¸ç”¨è¨»å†Šï¼Œè¼¸å…¥é£¢é¤“åº¦èˆ‡å¿ƒæƒ…ï¼Œ3ç§’å¹«ä½ æ±ºå®šä»Šæ™šåƒç«é‹ã€ç‡’è‚‰é‚„æ˜¯èˆ’è‚¥é¤ç›’ã€‚">
    <meta name="keywords" content="æ™šé¤åƒä»€éº¼, é¸æ“‡å›°é›£, ç¾é£Ÿæ¨è–¦, æ™šé¤è½‰ç›¤, å°åŒ—ç¾é£Ÿ, æ™šé¤åƒå•¥, éš¨æ©Ÿæ™šé¤">
    <meta name="author" content="æ™šé¤æ•‘æ˜Ÿåœ˜éšŠ">
    <!-- ç¤¾ç¾¤åˆ†äº«é è¦½ (ç•¶ç¶²å€è²¼åˆ° Line/FB æ™‚é¡¯ç¤ºçš„å…§å®¹) -->
    <meta property="og:title" content="æ™šé¤åƒä»€éº¼ | é¸æ“‡å›°é›£æ•‘æ˜Ÿ">
    <meta property="og:description" content="åˆ¥å†èªªéš¨ä¾¿äº†ï¼ä¸€éµå¹«ä½ æ±ºå®šä»Šæ™šåƒä»€éº¼ï¼Œå„ç¨®éš±è—ç‰ˆç¾é£Ÿéˆæ„Ÿéƒ½åœ¨é€™ã€‚">
    <meta property="og:type" content="website">

    <!-- === Google Analytics è¿½è¹¤ç¢¼ (è«‹æ›¿æ› ID) === -->
    <!-- 1. è«‹å°‡ 'G-YOUR_ID_HERE' æ›¿æ›æˆæ‚¨åœ¨ GA å¾Œå°æ‹¿åˆ°çš„ 'è©•ä¼° ID' (ä¾‹å¦‚ G-12345ABCDE) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-C5JJTP8L35"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      // 2. ä¸‹é¢é€™è¡Œä¹Ÿè¦æ›¿æ› ID
      gtag('config', 'G-C5JJTP8L35');
    </script>
    <!-- ========================================== -->

    <style>
        :root {
            /* å»¶çºŒæ‚¨å–œæ­¡çš„ v4.0 æš–è‰²èª¿ */
            --primary: #FF9F43; /* æ´»åŠ›æ©˜ */
            --primary-dark: #EE5A24; /* æ·±æ©˜ç´… */
            --bg-color: #fdf6e3; /* æº«æš–ç±³é»ƒ */
            --card-bg: #ffffff;
            --text-main: #2d3436; /* æ·±ç° */
            --text-sub: #636e72;
            --border-color: #FFC312;
            --selected-bg: #ffeaa7;
            --whatever-bg: #dfe6e9;
        }

        body {
            font-family: 'PingFang TC', 'Microsoft JhengHei', sans-serif;
            background: var(--bg-color);
            background-image: radial-gradient(#ffeaa7 15%, transparent 15%), radial-gradient(#ffeaa7 15%, transparent 15%);
            background-size: 24px 24px;
            background-position: 0 0, 12px 12px;
            margin: 0;
            padding: 0;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: var(--text-main);
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        .container {
            width: 100%;
            max-width: 480px;
            padding: 15px;
            box-sizing: border-box;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .card {
            background: var(--card-bg);
            border-radius: 24px;
            box-shadow: 0 8px 32px rgba(255, 159, 67, 0.15);
            border: 2px solid #fff;
            padding: 20px;
            display: flex;
            flex-direction: column;
            flex: 1;
            max-height: 95vh;
            position: relative;
            overflow: hidden;
            transition: all 0.3s;
        }

        h1 {
            font-size: 1.8rem;
            margin: 0;
            text-align: center;
            color: var(--text-main);
            font-weight: 900;
            letter-spacing: 1px;
        }

        .subtitle {
            font-size: 0.9rem;
            color: var(--text-sub);
            text-align: center;
            margin-bottom: 15px;
            line-height: 1.4;
        }

        /* æŒ‰éˆ•æ¨£å¼ */
        .option-btn {
            background: #fff;
            border: 2px solid #dfe6e9;
            border-radius: 16px;
            padding: 15px;
            text-align: left;
            font-size: 1rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            color: var(--text-main);
            transition: all 0.1s;
            margin-bottom: 10px;
            position: relative;
        }
        .option-btn:active { transform: scale(0.98); }
        
        .option-btn.selected {
            background: var(--selected-bg);
            border-color: var(--primary-dark);
        }
        .option-btn.selected::after {
            content: "âœ…";
            position: absolute;
            right: 15px;
            font-size: 1.2rem;
        }

        /* éƒ½å¯ä»¥æŒ‰éˆ• */
        .option-btn.whatever {
            background: var(--whatever-bg);
            border-style: dashed;
            color: var(--text-sub);
        }
        .option-btn.whatever.selected {
            background: #b2bec3;
            color: #fff;
            border-color: var(--text-sub);
        }

        .emoji { font-size: 1.8rem; margin-right: 15px; min-width: 40px; text-align: center; }
        .text-group { display: flex; flex-direction: column; }
        .main-text { font-weight: bold; font-size: 1.05rem; }
        .sub-text { font-size: 0.8rem; opacity: 0.8; margin-top: 4px; }

        /* æ ¼é¬¥å ´æ¨£å¼ */
        .elimination-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            overflow-y: auto;
            padding: 5px;
            flex: 1;
        }

        .food-item {
            background: white;
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: 12px 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 85px;
        }

        .food-item .food-emoji { font-size: 2rem; margin-bottom: 5px; }
        .food-item .food-name { font-size: 1rem; font-weight: bold; line-height: 1.2; }

        .food-item.killed {
            background: #fab1a0;
            border-color: #fab1a0;
            opacity: 0.5;
            transform: scale(0.9);
            filter: grayscale(0.5);
        }
        .food-item.killed::after {
            content: "âŒ";
            position: absolute;
            font-size: 3rem;
            opacity: 0.8;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        /* åº•éƒ¨å¤§æŒ‰éˆ• */
        .big-btn {
            padding: 16px;
            font-size: 1.1rem;
            border: none;
            background: linear-gradient(135deg, #FF9F43 0%, #EE5A24 100%);
            color: white;
            border-radius: 16px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            box-shadow: 0 4px 15px rgba(238, 90, 36, 0.3);
            margin-top: 10px;
            transition: transform 0.1s;
        }
        .big-btn:active { transform: scale(0.95); }
        .big-btn.secondary {
            background: white;
            border: 2px solid var(--primary);
            color: var(--primary-dark);
            box-shadow: none;
        }
        
        .action-row {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        .action-row .big-btn {
            margin-top: 0;
            flex: 1;
            font-size: 1rem;
            padding: 14px;
        }

        /* çµæœé  */
        .result-list { flex: 1; overflow-y: auto; margin: 10px 0; display: flex; flex-direction: column; gap: 10px; }
        .result-card {
            border: 2px solid var(--primary);
            border-radius: 16px;
            padding: 15px;
            background: #fff;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }
        .gmap-link {
            background: #4285F4; color: white; text-decoration: none;
            padding: 10px 15px; border-radius: 10px; font-size: 0.9rem; font-weight: bold;
        }

        .hidden { display: none !important; }
        .nav-header { display: flex; justify-content: space-between; margin-bottom: 10px; }
        .back-text { color: var(--text-sub); font-size: 0.9rem; cursor: pointer; padding: 5px; }

        /* æµ®å‹•æé†’ (Toast) */
        .roast-toast {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.85);
            color: white;
            padding: 15px 20px;
            border-radius: 12px;
            font-size: 1rem;
            z-index: 10;
            animation: popIn 0.3s;
            text-align: center;
        }
        @keyframes popIn { from {opacity:0; transform: translate(-50%, -40%);} to {opacity:1; transform: translate(-50%, -50%);} }
        
        .cvs-notice {
            font-size: 0.8rem;
            color: #b2bec3;
            text-align: center;
            margin-top: 10px;
            font-style: italic;
        }
    </style>
</head>
<body>

<div class="container">
    
    <!-- 1. é¦–é  -->
    <div id="screen-home" class="card">
        <div style="flex:1; display:flex; flex-direction:column; justify-content:center; align-items:center;">
            <div style="font-size: 5rem; margin-bottom: 10px;">ğŸ¤¤</div>
            <h1>æ™šé¤åƒä»€éº¼<br><span style="font-size:1rem; font-weight:normal; background: var(--primary); color: white; padding: 2px 8px; border-radius: 20px;">é¸æ“‡å›°é›£æ•‘æ˜Ÿ</span></h1>
            <p style="color: var(--text-sub); margin-top: 15px; text-align: center; line-height: 1.6;">
                ä¸å•ä½ æƒ³åƒé£¯é‚„æ˜¯éºµï¼Œ<br>
                åªå•ä½ ä»Šå¤©çš„ã€Œæ„Ÿè¦ºã€å°ä¸å°ã€‚<br>
            </p>
        </div>
        <button class="big-btn" onclick="goToFilter()">ğŸ“ é–‹å§‹ç¯©é¸</button>
        <button class="big-btn secondary" onclick="startRandom()">ğŸ² éš¨æ©Ÿä¸€ç™¼</button>
        <div class="cvs-notice">
            ğŸ“¢ ç³»çµ±å…¬å‘Šï¼šè¶…å•†å› ç‚ºå¤ªç„¡æ•µæœƒå®³ç³»çµ±ç•¶æ©Ÿï¼Œ<br>è«‹å·¦è½‰å‡ºé–€è‡ªå·±è²· (ç¬‘)
        </div>
    </div>

    <!-- 2. å¤§æ–¹å‘ç¯©é¸ (Vibe Check) -->
    <div id="screen-filter" class="card hidden">
        <div class="nav-header"><span class="back-text" onclick="goHome()">â¬… å›é¦–é </span></div>
        
        <h1>ä»Šå¤©æ™šé¤ï¼Œåƒé»å¥½çš„</h1>
        <p class="subtitle">å›ç­”é€™å››é¡Œï¼Œç¯©å‡ºä½ æƒ³åƒçš„ã€Œæ°›åœã€</p>

        <div style="flex:1; overflow-y:auto; padding-right: 5px;">
            
            <!-- Q1 ç¤¾äº¤ (Social) -->
            <div style="margin-bottom: 25px;">
                <p class="main-text">1. ä»Šå¤©æ˜¯ä»€éº¼å±€ï¼Ÿ</p>
                <div class="option-btn" onclick="setFilter('social', 'solo', this)" data-q="social">
                    <span class="emoji">ğŸ§</span>
                    <div class="text-group"><span class="main-text">å­¤ç¨ç¾é£Ÿå®¶</span><span class="sub-text">ä¸€äººé£Ÿï¼Œè‡ªåœ¨æœ€é‡è¦ (è§£é–å°åƒ/ä¾¿ç•¶)</span></div>
                </div>
                <div class="option-btn" onclick="setFilter('social', 'group', this)" data-q="social">
                    <span class="emoji">ğŸ»</span>
                    <div class="text-group"><span class="main-text">æœ‹å‹/å®¶åº­èšé¤</span><span class="sub-text">éœ€è¦åä¸‹ä¾†å¥½å¥½èŠ (å°æ®ºç”Ÿå­˜é¡é£Ÿç‰©)</span></div>
                </div>
                <div class="option-btn whatever" onclick="setFilter('social', 'any', this)" data-q="social">
                    <span class="emoji">ğŸ¤·â€â™‚ï¸</span>
                    <div class="text-group"><span class="main-text">éƒ½å¯ä»¥</span><span class="sub-text">æ²’å·®ï¼Œå¥½åƒå°±è¡Œ</span></div>
                </div>
            </div>

            <!-- Q2 ç½ªæƒ¡æ„Ÿ (Health) -->
            <div style="margin-bottom: 25px;">
                <p class="main-text">2. é—œæ–¼ã€Œç½ªæƒ¡æ„Ÿã€é€™ä»¶äº‹...</p>
                <div class="option-btn" onclick="setFilter('health', 'heavy', this)" data-q="health">
                    <span class="emoji">ğŸ˜ˆ</span>
                    <div class="text-group"><span class="main-text">å¿«æ¨‚è‡³ä¸Š (é«˜ç†±é‡)</span><span class="sub-text">ç‚¸é›ã€äº”èŠ±è‚‰ã€å…¨ç³–ï¼Œäººç”Ÿè‹¦çŸ­åƒå°±å°äº†ï¼</span></div>
                </div>
                <div class="option-btn" onclick="setFilter('health', 'normal', this)" data-q="health">
                    <span class="emoji">âš–ï¸</span>
                    <div class="text-group"><span class="main-text">å‡è¡¡é©ä¸­ (æ¨™æº–)</span><span class="sub-text">æœ‰èœæœ‰è‚‰çš„ä¾¿ç•¶ã€å®šé£Ÿï¼Œåšå€‹æ­£å¸¸äºº</span></div>
                </div>
                <div class="option-btn" onclick="setFilter('health', 'diet', this)" data-q="health">
                    <span class="emoji">ğŸ¥—</span>
                    <div class="text-group"><span class="main-text">é‚„å‚µæ™‚åˆ» (æ¸…æ·¡)</span><span class="sub-text">æœ€è¿‘åƒå¤ªå¥½ï¼Œä»Šæ™šæƒ³æ¸…è…¸èƒƒã€åƒè‰</span></div>
                </div>
                 <div class="option-btn" onclick="setFilter('health', 'survival', this)" data-q="health">
                    <span class="emoji">ğŸ”‹</span>
                    <div class="text-group"><span class="main-text">æ¥µç°¡å……é£¢ (ç”Ÿå­˜)</span><span class="sub-text">æœˆåº•äº†ï¼Œèƒ½æ­¢é¤“æ´»ä¸‹å»å°±å¥½</span></div>
                </div>
                <div class="option-btn whatever" onclick="setFilter('health', 'any', this)" data-q="health">
                    <span class="emoji">ğŸ¤·â€â™‚ï¸</span>
                    <div class="text-group"><span class="main-text">éƒ½å¯ä»¥</span><span class="sub-text">ç†±é‡ä»€éº¼çš„ï¼Œéš¨é¢¨å»å§</span></div>
                </div>
            </div>

            <!-- Q3 ç‹€æ…‹/æº«åº¦ (Temp) -->
            <div style="margin-bottom: 25px;">
                <p class="main-text">3. å£æ„Ÿç‰©ç†ç‹€æ…‹ï¼Ÿ</p>
                <div class="option-btn" onclick="setFilter('temp', 'hot', this)" data-q="temp">
                    <span class="emoji">â™¨ï¸</span>
                    <div class="text-group"><span class="main-text">éˆé­‚é«˜æº«ç‡‰ç…®</span><span class="sub-text">ç«ç†±éˆé­‚æ¹¯ï¼šç«é‹ã€æ¹¯éºµã€ç†±ç²¥ (æƒ³å–ç†±æ¹¯å–åˆ°ç™¼æ±—)</span></div>
                </div>
                <div class="option-btn" onclick="setFilter('temp', 'dry', this)" data-q="temp">
                    <span class="emoji">ğŸŒµ</span>
                    <div class="text-group"><span class="main-text">å¡æ»‹å¡æ»‹ç¡¬æ´¾</span><span class="sub-text">æ‹’çµ•æ¿•é»ï¼šç‚¸ç‰©ã€çƒ¤ç‰©ã€ä¹¾éºµ (è¦è„†è¦ä¹¾ï¼Œç´”ç²¹ç™¼æ´©)</span></div>
                </div>
                <div class="option-btn" onclick="setFilter('temp', 'cold', this)" data-q="temp">
                    <span class="emoji">â„ï¸</span>
                    <div class="text-group"><span class="main-text">èˆŒå°–é™æº«è¨ˆç•«</span><span class="sub-text">æ¶¼æ‹Œã€ç”Ÿé£Ÿã€æ²™æ‹‰ (æ‹’çµ•ç†±æ°£ï¼Œå†·éœä¸€ä¸‹)</span></div>
                </div>
                 <div class="option-btn whatever" onclick="setFilter('temp', 'any', this)" data-q="temp">
                    <span class="emoji">ğŸ¤·â€â™‚ï¸</span>
                    <div class="text-group"><span class="main-text">éƒ½å¯ä»¥</span><span class="sub-text">å†·ç†±ä¸æ‹˜</span></div>
                </div>
            </div>

            <!-- Q4 ç”¨é¤ç›®çš„ (Purpose) -->
            <div>
                <p class="main-main-text">4. ä»Šå¤©é€™é¤çš„ã€Œç›®çš„ã€æ˜¯ï¼Ÿ</p>
                <div class="option-btn" onclick="setFilter('purpose', 'meal', this)" data-q="purpose">
                    <span class="emoji">ğŸ½ï¸</span>
                    <div class="text-group"><span class="main-text">ä¸»é¤ç´š</span><span class="sub-text">æˆ‘è¦é£½è¶³æ„Ÿï¼Œæœ‰é£¯æœ‰éºµæœ‰èœï¼Œåƒé£½åƒæ»¿</span></div>
                </div>
                <div class="option-btn" onclick="setFilter('purpose', 'snack', this)" data-q="purpose">
                    <span class="emoji">â˜•</span>
                    <div class="text-group"><span class="main-text">å……é£¢å¢Šèƒƒ</span><span class="sub-text">é»å¿ƒã€å°åƒã€å¡«ç¸«ï¼Œæ­£é¤å¯ä»¥çœç•¥</span></div>
                </div>
                 <div class="option-btn whatever" onclick="setFilter('purpose', 'any', this)" data-q="purpose">
                    <span class="emoji">ğŸ¤·â€â™‚ï¸</span>
                    <div class="text-group"><span class="main-text">éƒ½å¯ä»¥</span><span class="sub-text">è‚šå­ä¸èªªè©±ï¼Œéš¨ç·£å³å¯</span></div>
                </div>
            </div>

        </div>
        <button class="big-btn" onclick="goToElimination()">ä¸‹ä¸€æ­¥ï¼šçœ‹åå–® â”</button>
    </div>

    <!-- 3. æ·˜æ±°æ ¼é¬¥å ´ -->
    <div id="screen-elimination" class="card hidden">
        <div class="nav-header"><span class="back-text" onclick="goToFilter()">â¬… ä¸Šä¸€æ­¥</span></div>
        
        <h1>ç›´è¦ºæ·˜æ±°è³½</h1>
        <p class="subtitle">çœ‹åˆ°å“ªå€‹<span style="color:#d63031; font-weight:bold;">ä¸æƒ³åƒ</span>ï¼Ÿé»æ“Šå®ƒè¸¢å‡ºå»ï¼</p>

        <div id="grid-container" class="elimination-grid">
            <!-- JS ç”Ÿæˆé£Ÿç‰©å¡ç‰‡ -->
        </div>

        <div id="roast-toast" class="roast-toast hidden"></div>

        <div class="action-row">
            <button class="big-btn secondary" onclick="loadNextBatch()">ğŸ”„ å†ä¾†16å€‹</button>
            <button class="big-btn" onclick="showFinalResult()">âœ¨ é€™äº›éƒ½è¡Œï¼</button>
        </div>
    </div>

    <!-- 4. çµæœé  -->
    <div id="screen-result" class="card hidden">
        <div style="text-align: center;">
            <span style="font-size: 3rem;">ğŸ‰</span>
            <h1>å€–å­˜è€…åå–®</h1>
            <p class="subtitle" id="result-subtitle"></p>
        </div>

        <div id="result-content" class="result-list"></div>

        <div class="reminder-box" style="background:#fff3cd; color:#856404; padding:10px; border-radius:12px; font-size:0.85rem; margin-top:auto; text-align:left; border-left:4px solid #ffc107;">
            ğŸ’¡ <strong>è€å¸æ©Ÿæé†’ï¼š</strong><br>
            æœå°‹å¾Œåˆ¥å¿˜äº†è¨­å®šï¼šé ç®— ($~$$$)ã€è·é›¢ã€ç‡Ÿæ¥­æ™‚é–“ã€‚
        </div>

        <button class="big-btn secondary" onclick="goHome()" style="margin-top: 10px;">
            ğŸ”„ é‡æ–°ä¸€å±€
        </button>
    </div>

</div>

<script>
    // --- 1. æµ·é‡è³‡æ–™åº« (v12.3 - ç´”ä¸­æ–‡) ---
    // æ¨™ç±¤ç³»çµ±: s(social), h(health), t(temp), p(purpose: meal/snack)
    const db = [
        // === é£¯é¡ (Rice) ===
        { n: "è‚‰çµ²è›‹ç‚’é£¯", s: "solo", h: "heavy", t: "dry", p: "meal", e: "ğŸš" },
        { n: "è¦ä»ç‚’é£¯", s: "solo", h: "heavy", t: "dry", p: "meal", e: "ğŸ¦" },
        { n: "éŸ“å¼æ³¡èœç‚’é£¯", s: "solo", h: "heavy", t: "dry", p: "meal", e: "ğŸš" },
        { n: "é®­é­šç‚’é£¯", s: "solo", h: "normal", t: "dry", p: "meal", e: "ğŸŸ" },
        { n: "å»£å¼ç‚’é£¯", s: "solo", h: "heavy", t: "dry", p: "meal", e: "ğŸš" },
        { n: "æ»·è‚‰é£¯+ç‡™é’èœ", s: "solo", h: "heavy", t: "hot", p: "meal", e: "ğŸš" },
        { n: "é›è‚‰é£¯", s: "solo", h: "heavy", t: "hot", p: "meal", e: "ğŸ“" },
        { n: "æ§è‚‰é£¯", s: "solo", h: "heavy", t: "hot", p: "meal", e: "ğŸ–" },
        { n: "å¤æ—©å‘³æ’éª¨é£¯", s: "solo", h: "heavy", t: "dry", p: "meal", e: "ğŸ–" },
        { n: "ç‚¸é›è…¿é£¯", s: "solo", h: "heavy", t: "dry", p: "meal", e: "ğŸ—" },
        { n: "ä¸‰å¯¶é£¯ (ç‡’è‡˜)", s: "solo", h: "heavy", t: "dry", p: "meal", e: "ğŸ¦†" },
        { n: "æµ·å—é›é£¯", s: "any", h: "diet", t: "hot", p: "meal", e: "ğŸ—" },
        { n: "æ³°å¼æ‰“æ‹‹è±¬è‚‰é£¯", s: "any", h: "heavy", t: "hot", p: "meal", e: "ğŸ‡¹ğŸ‡­" },
        { n: "æ—¥å¼å’–å“©é£¯", s: "any", h: "normal", t: "hot", p: "meal", e: "ğŸ›" },
        { n: "æ—¥å¼ä¸¼é£¯ (ç‰›/è±¬)", s: "any", h: "heavy", t: "hot", p: "meal", e: "ğŸ¥©" },
        { n: "è’²ç‡’é°»é­šé£¯", s: "any", h: "heavy", t: "hot", p: "meal", e: "ğŸ£" },
        { n: "å®®ä¿é›ä¸é£¯", s: "any", h: "heavy", t: "hot", p: "meal", e: "ğŸŒ¶ï¸" },
        { n: "æ­å§†è›‹åŒ…é£¯", s: "any", h: "normal", t: "hot", p: "meal", e: "ğŸ³" },
        { n: "æ»‘è›‹ç‰›è‚‰ç‡´é£¯", s: "solo", h: "normal", t: "hot", p: "meal", e: "ğŸ›" },
        { n: "æµ·é®®ç‡´é£¯", s: "solo", h: "normal", t: "hot", p: "meal", e: "ğŸ¦‘" },
        { n: "çŸ³é‹æ‹Œé£¯", s: "any", h: "normal", t: "hot", p: "meal", e: "ğŸ¥˜" },
        { n: "å»£æ±ç²¥", s: "solo", h: "diet", t: "hot", p: "snack", e: "ğŸ¥£" },
        { n: "çš®è›‹ç˜¦è‚‰ç²¥", s: "solo", h: "diet", t: "hot", p: "snack", e: "ğŸ¥£" },
        { n: "é¹¹è›‹é»ƒç‚’é£¯", s: "solo", h: "heavy", t: "dry", p: "meal", e: "ğŸš" },
        { n: "ç­’ä»”ç±³ç³•", h: "light", t: "dry", p: "snack", e: "ğŸš" },
        { n: "è¶…å•†å¾¡é£¯ç³°", s: "solo", h: "survival", t: "cold", p: "snack", e: "ğŸ™" },
        { n: "èˆ’è‚¥é›èƒ¸é¤ç›’", s: "solo", h: "diet", t: "dry", p: "meal", e: "ğŸ±" },
        { n: "ç´ é£Ÿå’–å“©é£¯", s: "any", h: "diet", t: "hot", p: "meal", e: "ğŸ›" },
        { n: "éº»å©†è±†è…é£¯", s: "solo", h: "heavy", t: "hot", p: "meal", e: "ğŸŒ¶ï¸" },
        { n: "çƒ¤é›è…¿ä¾¿ç•¶", s: "solo", h: "normal", t: "dry", p: "meal", e: "ğŸ±" },
        { n: "è—œéº¥é®­é­šé¤ç›’", s: "solo", h: "diet", t: "cold", p: "meal", e: "ğŸŸ" },
        { n: "äº”ç©€é£¯ç³°", s: "solo", h: "diet", t: "cold", p: "snack", e: "ğŸ™" },
        
        // === éºµé¡ (Noodle) ===
        { n: "æ¸…ç‡‰ç‰›è‚‰éºµ", s: "any", h: "diet", t: "hot", p: "meal", e: "ğŸœ" },
        { n: "ç´…ç‡’ç‰›è‚‰éºµ", s: "any", h: "heavy", t: "hot", p: "meal", e: "ğŸŒ¶ï¸" },
        { n: "éº»é†¬éºµ", s: "solo", h: "heavy", t: "hot", p: "meal", e: "ğŸ" },
        { n: "ç‚¸é†¬éºµ", s: "solo", h: "heavy", t: "hot", p: "meal", e: "ğŸ" },
        { n: "é™½æ˜¥éºµ (æ¹¯)", s: "solo", h: "light", t: "hot", p: "snack", e: "ğŸœ" },
        { n: "åˆ‡ä»”éºµ", s: "solo", h: "light", t: "hot", p: "snack", e: "ğŸœ" },
        { n: "é¤›é£©éºµ", s: "solo", h: "light", t: "hot", p: "meal", e: "ğŸ¥Ÿ" },
        { n: "æ¶¼éºµ", s: "solo", h: "normal", t: "cold", p: "snack", e: "â„ï¸" },
        { n: "ç¾©å¤§åˆ©éºµ (ç™½é†¬)", s: "group", h: "heavy", t: "hot", p: "meal", e: "ğŸ" },
        { n: "ç¾©å¤§åˆ©éºµ (é’é†¬)", s: "group", h: "normal", t: "hot", p: "meal", e: "ğŸ" },
        { n: "ç¾©å¤§åˆ©éºµ (ç´…é†¬)", s: "group", h: "normal", t: "hot", p: "meal", e: "ğŸ" },
        { n: "è±šéª¨æ‹‰éºµ", s: "any", h: "heavy", t: "hot", p: "meal", e: "ğŸ¥" },
        { n: "å‘³å™Œæ‹‰éºµ", s: "any", h: "heavy", t: "hot", p: "meal", e: "ğŸ¥" },
        { n: "æ—¥å¼æ²¾éºµ", s: "solo", h: "normal", t: "hot", p: "meal", e: "ğŸœ" },
        { n: "ç‚’æ³¡éºµ", s: "solo", h: "heavy", t: "dry", p: "snack", e: "ğŸœ" },
        { n: "å°å¼ç‚’éºµ", s: "heavy", t: "dry", p: "meal", e: "ğŸ" },
        { n: "ä¹¾ç‚’ç‰›æ²³", s: "heavy", t: "dry", p: "meal", e: "ğŸ" },
        { n: "å»£æ±ç‚’éºµ", s: "heavy", t: "hot", p: "meal", e: "ğŸ" },
        { n: "è¶Šå—æ²³ç²‰", s: "any", h: "diet", t: "hot", p: "meal", e: "ğŸ‡»ğŸ‡³" },
        { n: "é‹ç‡’æ„éºµ", s: "solo", h: "heavy", t: "hot", p: "meal", e: "ğŸ²" },
        { n: "çƒé¾éºµ (æ¹¯)", s: "any", h: "normal", t: "hot", p: "meal", e: "ğŸ²" },
        { n: "ç‚’çƒé¾", s: "any", h: "heavy", t: "hot", p: "meal", e: "ğŸ" },
        { n: "ç±³ç²‰æ¹¯", s: "solo", h: "light", t: "hot", p: "snack", e: "ğŸ¥£" },
        { n: "è‚‰ç¾¹éºµ", s: "solo", h: "heavy", t: "hot", p: "meal", e: "ğŸ²" },
        { n: "èšµä»”éºµç·š", s: "solo", h: "heavy", t: "hot", p: "snack", e: "ğŸ¦ª" },
        { n: "èºè„ç²‰", s: "solo", h: "heavy", t: "hot", p: "meal", e: "ğŸŒ¶ï¸" },
        { n: "å¤§æ»·éºµ", s: "solo", h: "heavy", t: "hot", p: "meal", e: "ğŸœ" },
        { n: "é…¸è¾£æ¹¯éºµ", s: "solo", h: "heavy", t: "hot", p: "meal", e: "ğŸŒ¶ï¸" },
        { n: "æ“”ä»”éºµ", s: "solo", h: "light", t: "hot", p: "snack", e: "ğŸœ" },
        { n: "æ¦¨èœè‚‰çµ²éºµ", s: "solo", h: "light", t: "hot", p: "meal", e: "ğŸœ" },
        { n: "é›çµ²éºµ", s: "solo", h: "survival", t: "hot", p: "snack", e: "ğŸœ" },
        { n: "è”¬èœé€šå¿ƒéºµ", s: "solo", h: "diet", t: "hot", p: "meal", e: "ğŸ" },
        { n: "æ¸…æ¹¯ç±³è‹”ç›®", s: "solo", h: "light", t: "hot", p: "snack", e: "ğŸ¥£" },
        
        // === éºµç²‰/é¤…çš® (Flour) ===
        { n: "é«˜éº—èœæ°´é¤ƒ", s: "solo", h: "normal", t: "hot", p: "meal", e: "ğŸ¥Ÿ" },
        { n: "é‹è²¼", s: "solo", h: "heavy", t: "dry", p: "snack", e: "ğŸ¥Ÿ" },
        { n: "å°ç± åŒ…", s: "any", h: "normal", t: "hot", p: "snack", e: "ğŸ¥¢" },
        { n: "ç¾å¼æ¼¢å ¡", s: "group", h: "heavy", t: "dry", p: "meal", e: "ğŸ”" },
        { n: "æŠ«è–©", s: "group", h: "heavy", t: "dry", p: "meal", e: "ğŸ•" },
        { n: "æ½›è‰‡å ¡", s: "solo", h: "diet", t: "cold", p: "meal", e: "ğŸ¥ª" },
        { n: "è”¥æŠ“é¤…åŠ è›‹", s: "solo", h: "heavy", t: "dry", p: "snack", e: "ğŸ¥" },
        { n: "è›‹é¤…", s: "solo", h: "light", t: "dry", p: "snack", e: "ğŸ³" },
        { n: "æ½¤é¤…", s: "solo", h: "diet", t: "cold", p: "snack", e: "ğŸŒ¯" },
        { n: "ä¸‰æ˜æ²»", s: "solo", h: "survival", t: "cold", p: "snack", e: "ğŸ¥ª" },
        { n: "åˆˆåŒ…", s: "solo", h: "heavy", t: "dry", p: "snack", e: "ğŸŒ®" },
        { n: "èƒ¡æ¤’é¤…", s: "solo", h: "heavy", t: "dry", p: "snack", e: "ğŸ«“" },
        { n: "è˜¿è””ç³•", s: "solo", h: "heavy", t: "dry", p: "snack", e: "ğŸ«“" },
        { n: "ç‡’é¤…æ²¹æ¢", s: "solo", h: "heavy", t: "dry", p: "snack", e: "ğŸ«“" },
        { n: "å°ç± æ¹¯åŒ…", s: "any", h: "normal", t: "hot", p: "snack", e: "ğŸ¥¢" },
        { n: "åƒå±¤éºµ", s: "group", h: "heavy", t: "hot", p: "meal", e: "ğŸ" },
        { n: "ç†±ç‹—å ¡", s: "solo", h: "heavy", t: "hot", p: "snack", e: "ğŸŒ­" },
        { n: "è‚‰åŒ…", s: "solo", h: "light", t: "hot", p: "snack", e: "åŒ…" },
        { n: "å¢¨è¥¿å“¥æ²é¤…", s: "solo", h: "normal", t: "dry", p: "meal", e: "ğŸŒ¯" },
        { n: "é¹¹æ´¾", s: "solo", h: "normal", t: "hot", p: "snack", e: "ğŸ¥§" },
        { n: "å…¨éº¥åå¸ä¸‰æ˜æ²»", s: "solo", h: "diet", t: "cold", p: "snack", e: "ğŸ¥ª" },
        { n: "é›è‚‰æ²é¤…", s: "solo", h: "normal", t: "hot", p: "snack", e: "ğŸŒ¯" },

        // === è‚‰é¡ (Meat/Protein) ===
        { n: "éŸ“å¼ç‚¸é›", s: "group", h: "heavy", t: "dry", p: "meal", e: "ğŸ—" },
        { n: "é¹¹é…¥é›", s: "solo", h: "heavy", t: "dry", p: "snack", e: "ğŸ”" },
        { n: "ç‚¸é›æ’", s: "solo", h: "heavy", t: "dry", p: "snack", e: "ğŸ“" },
        { n: "æ—¥å¼ç‚¸è±¬æ’", s: "any", h: "heavy", t: "dry", p: "meal", e: "ğŸ·" },
        { n: "å¹³åƒ¹éµæ¿ç‡’", s: "any", h: "normal", t: "hot", p: "meal", e: "ğŸ”¥" },
        { n: "ç‡’è‚‰åƒåˆ°é£½", s: "group", h: "heavy", t: "dry", p: "meal", e: "ğŸ¥“" },
        { n: "çƒ¤è‚‰ä¸²", s: "solo", h: "light", t: "dry", p: "snack", e: "ğŸ¢" },
        { n: "ç”Ÿé­šç‰‡", s: "any", h: "diet", t: "cold", p: "snack", e: "ğŸ£" },
        { n: "æ¡å£½å¸", s: "any", h: "diet", t: "cold", p: "snack", e: "ğŸ£" },
        { n: "è¿´è½‰å£½å¸", s: "any", h: "normal", t: "cold", p: "meal", e: "ğŸ£" },
        { n: "ç‰›æ’ (æ’é¤)", s: "group", h: "heavy", t: "dry", p: "meal", e: "ğŸ¥©" },
        { n: "é†‰é›", s: "group", h: "diet", t: "cold", p: "snack", e: "ğŸ—" },
        { n: "æ¡¶ä»”é›", s: "group", h: "normal", t: "dry", p: "meal", e: "ğŸ”" },
        { n: "çƒ¤é­šä¸‹å·´", s: "solo", h: "diet", t: "dry", p: "snack", e: "ğŸŸ" },
        { n: "æ¸…è’¸é­š", s: "group", h: "diet", t: "hot", p: "meal", e: "ğŸŸ" },
        { n: "çƒ¤é›è…¿", s: "solo", h: "normal", t: "dry", p: "meal", e: "ğŸ—" },
        { n: "æ²™æ‹‰ (åŠ é›è‚‰)", s: "solo", h: "diet", t: "cold", p: "meal", e: "ğŸ¥—" },
        { n: "æ¤’éº»é›", s: "group", h: "heavy", t: "dry", p: "meal", e: "ğŸŒ¶ï¸" },
        { n: "ä½è„‚ç‰›æ’ (å–®é»)", s: "any", h: "diet", t: "hot", p: "meal", e: "ğŸ¥©" },
        { n: "èˆ’è‚¥é›èƒ¸æ²™æ‹‰", s: "solo", h: "diet", t: "cold", p: "snack", e: "ğŸ¥—" },
        { n: "æ¸…è’¸è¦", s: "group", h: "diet", t: "hot", p: "snack", e: "ğŸ¦" },
        { n: "çƒ¤é¯–é­šå®šé£Ÿ", s: "solo", h: "diet", t: "hot", p: "meal", e: "ğŸŸ" },
        
        // === é‹ç‰©/æ¹¯é¡ (Soup/Pot) ===
        { n: "ç¾Šè‚‰çˆ", s: "group", h: "heavy", t: "hot", p: "meal", e: "ğŸ²" },
        { n: "è–‘æ¯é´¨", s: "group", h: "heavy", t: "hot", p: "meal", e: "ğŸ¦†" },
        { n: "è‡­è‡­é‹/å°ç«é‹", s: "any", h: "normal", t: "hot", p: "meal", e: "ğŸ²" },
        { n: "éº»è¾£é‹", s: "group", h: "heavy", t: "hot", p: "meal", e: "ğŸŒ¶ï¸" },
        { n: "æµ·é®®è±†è…é‹", s: "any", h: "normal", t: "hot", p: "meal", e: "ğŸ²" },
        { n: "é…¸èœç™½è‚‰é‹", s: "group", h: "heavy", t: "hot", p: "meal", e: "ğŸ²" },
        { n: "å£½å–œç‡’", s: "group", h: "heavy", t: "hot", p: "meal", e: "ğŸ¥©" },
        { n: "è—¥ç‡‰æ’éª¨", s: "solo", h: "diet", t: "hot", p: "snack", e: "ğŸ–" },
        { n: "æ¸…ç‡‰æ’éª¨æ¹¯", s: "solo", h: "diet", t: "hot", p: "snack", e: "ğŸ¥£" },
        { n: "é¦™è‡é›æ¹¯", s: "group", h: "diet", t: "hot", p: "snack", e: "ğŸ¥£" },
        { n: "ç‰ç±³æ¿ƒæ¹¯", s: "solo", h: "heavy", t: "hot", p: "snack", e: "ğŸ¥£" },
        { n: "é…¸è¾£æ¹¯", s: "solo", h: "heavy", t: "hot", p: "snack", e: "ğŸŒ¶ï¸" },
        { n: "éƒ¨éšŠé‹", s: "group", h: "heavy", t: "hot", p: "meal", e: "ğŸœ" },
        { n: "å’–å“©æ¹¯", s: "solo", h: "normal", t: "hot", p: "snack", e: "ğŸ›" },
        { n: "å‘³å™Œæ¹¯", s: "solo", h: "light", t: "hot", p: "snack", e: "ğŸ¥£" },
        { n: "è±¬è¡€æ¹¯", s: "solo", h: "light", t: "hot", p: "snack", e: "ğŸ¥£" },
        { n: "ç”œæ¹¯ (ç´…è±†/ç¶ è±†)", s: "solo", h: "heavy", t: "hot", p: "snack", e: "ğŸ«˜" },
        { n: "è”¬èœæ¸…æ¹¯", s: "solo", h: "diet", t: "hot", p: "snack", e: "ğŸ¥£" },
        { n: "å—ç“œæ¿ƒæ¹¯", s: "solo", h: "normal", t: "hot", p: "snack", e: "ğŸ¥£" },

        // === æ‹¼ç›¤/å°åƒ/ç”œé» (Mix/Small Eats) ===
        { n: "ä¹¾å¼æ»·å‘³", s: "solo", h: "normal", t: "dry", p: "snack", e: "ğŸ¥š" },
        { n: "éº»è¾£ç‡™", s: "solo", h: "heavy", t: "hot", p: "meal", e: "ğŸŒ¶ï¸" },
        { n: "é¹¹æ°´é›", s: "solo", h: "diet", t: "cold", p: "meal", e: "ğŸ”" },
        { n: "é—œæ±ç…®", s: "solo", h: "normal", t: "hot", p: "snack", e: "ğŸ¢" },
        { n: "æ¸…ç²¥å°èœ", s: "any", h: "diet", t: "hot", p: "meal", e: "ğŸš" },
        { n: "ç‚¸è‡­è±†è…", s: "solo", h: "heavy", t: "dry", p: "snack", e: "ğŸ‘ƒ" },
        { n: "éº»è¾£é´¨è¡€", s: "any", h: "heavy", t: "hot", p: "snack", e: "ğŸŒ¶ï¸" },
        { n: "èšµä»”ç…", s: "solo", h: "heavy", t: "hot", p: "snack", e: "ğŸ¦ª" },
        { n: "è‚‰åœ“", s: "solo", h: "heavy", t: "hot", p: "snack", e: "ğŸ”®" },
        { n: "ç¢—ç²¿", s: "solo", h: "normal", t: "hot", p: "snack", e: "ğŸ¥£" },
        { n: "å¤§è…¸åŒ…å°è…¸", s: "solo", h: "heavy", t: "dry", p: "snack", e: "ğŸŒ­" },
        { n: "è±†æ¼¿æ²¹æ¢", s: "solo", h: "heavy", t: "hot", p: "snack", e: "ğŸ¥›" },
        { n: "çç å¥¶èŒ¶", s: "solo", h: "heavy", t: "cold", p: "snack", e: "ğŸ§‹" },
        { n: "ç¶ è±†æ¹¯", s: "solo", h: "diet", t: "cold", p: "snack", e: "ğŸ«˜" },
        { n: "è±†èŠ±", s: "solo", h: "normal", t: "cold", p: "snack", e: "ğŸ®" },
        { n: "ç‡’ä»™è‰", s: "solo", h: "normal", t: "hot", p: "snack", e: "ğŸ®" },
        { n: "åˆ¨å†°", s: "solo", h: "heavy", t: "cold", p: "snack", e: "ğŸ§" },
        { n: "ç´…è±†é¤…/è»Šè¼ªé¤…", s: "solo", h: "light", t: "hot", p: "snack", e: "ğŸ˜" },
        { n: "æ²™æ‹‰ (å–®ç´”è”¬èœ)", s: "solo", h: "diet", t: "cold", p: "snack", e: "ğŸ¥—" },
        { n: "åå¸å¤¾è›‹", s: "solo", h: "survival", t: "hot", p: "snack", e: "ğŸ¥ª" },
        { n: "åœ°ç“œ (çƒ¤)", s: "solo", h: "diet", t: "hot", p: "snack", e: "ğŸ " },
        { n: "çƒ¤ç”œä¸è¾£", s: "solo", h: "normal", t: "dry", p: "snack", e: "ğŸ¢" },
        { n: "çƒ¤ç‰ç±³", s: "solo", h: "heavy", t: "dry", p: "snack", e: "ğŸŒ½" },
        { n: "èŒ¶è‘‰è›‹", s: "solo", h: "diet", t: "hot", p: "snack", e: "ğŸ¥š" },
        { n: "é›è›‹ç³•", s: "solo", h: "light", t: "hot", p: "snack", e: "ğŸ§‡" },
        { n: "æ°´æœæ‹¼ç›¤", s: "solo", h: "diet", t: "cold", p: "snack", e: "ğŸ¥" },
        { n: "é®®å¥¶", s: "solo", h: "diet", t: "cold", p: "snack", e: "ğŸ¥›" },
        { n: "å„ªæ ¼", s: "solo", h: "diet", t: "cold", p: "snack", e: "ğŸ¦" }
    ];

    // --- 2. ç‹€æ…‹ç®¡ç† ---
    // é è¨­å€¼ï¼šsolo, normal, hot, meal
    let filters = { social: 'solo', health: 'normal', temp: 'hot', purpose: 'meal' }; 
    let candidates = [];
    let killedIndices = new Set();
    let filteredPool = [];
    let poolIndex = 0; 

    // --- 3. é é¢è·³è½‰é‚è¼¯ ---
    function goHome() {
        showScreen('screen-home');
    }

    function goToFilter() {
        showScreen('screen-filter');
        
        document.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
        
        // æ ¹æ“šç•¶å‰ filters ç‹€æ…‹ï¼Œé‡æ–°é¸ä¸­æŒ‰éˆ• (ä¿®å¾©æ–¹æ¡ˆ)
        selectBtn('social', filters.social);
        selectBtn('health', filters.health);
        selectBtn('temp', filters.temp);
        selectBtn('purpose', filters.purpose);
    }

    function setFilter(type, val, btn) {
        filters[type] = val;
        const group = document.querySelectorAll(`[data-q="${type}"]`);
        group.forEach(b => b.classList.remove('selected'));
        btn.classList.add('selected');
    }

    function selectBtn(type, val) {
        // ä¿®æ­£ï¼šä½¿ç”¨å±¬æ€§é¸æ“‡å™¨ä¾†åŒ¹é… val
        const btn = document.querySelector(`[data-q="${type}"][onclick*="'${val}'"]`);
        if(btn) btn.classList.add('selected');
    }

    function goToElimination() {
        // 1. ç¯©é¸é‚è¼¯ (æ°›åœç¯©é¸)
        let initialList = db.filter(item => {
            let sMatch = false;
            // Q1 ç¤¾äº¤åŒ¹é…
            if (filters.social === 'any') sMatch = true;
            else if (filters.social === 'solo') sMatch = (item.s === 'solo' || item.s === 'any');
            else if (filters.social === 'group') sMatch = (item.s === 'group' || item.s === 'any');

            // Q2 ç½ªæƒ¡æ„ŸåŒ¹é…
            const healthMatch = (filters.health === 'any') || (item.h === filters.health);
            // Q3 æº«åº¦åŒ¹é…
            const tempMatch = (filters.temp === 'any') || (item.t === filters.temp);
            // Q4 ç›®çš„åŒ¹é… (æ–°å¢)
            const purposeMatch = (filters.purpose === 'any') || (item.p === filters.purpose);
            
            return sMatch && healthMatch && tempMatch && purposeMatch; // æ‰€æœ‰æ¢ä»¶ AND
        });
        
        // è‡ªå‹•æ”¾å¯¬ (å¦‚æœç¯©é¸å¤ªåš´è‹›ï¼Œå‰‡å¿½ç•¥ç›®çš„ Q4 å’Œ ç½ªæƒ¡æ„Ÿ Q2)
        if (initialList.length < 4) {
            initialList = db.filter(item => {
                 let sMatch = false;
                if (filters.social === 'any') sMatch = true;
                else if (filters.social === 'solo') sMatch = (item.s === 'solo' || item.s === 'any');
                else if (filters.social === 'group') sMatch = (item.s === 'group' || item.s === 'any');
                
                const tempMatch = (filters.temp === 'any') || (item.t === filters.temp);
                const purposeMatch = (filters.purpose === 'any') || (item.p === filters.purpose);

                // å¿½ç•¥ health æ¢ä»¶ï¼Œåƒ…ä¿ç•™ social, temp, purpose
                return sMatch && tempMatch && purposeMatch;
            });
        }

        // 2. åˆå§‹åŒ–ç‰Œåº«
        filteredPool = shuffle(initialList);
        poolIndex = 0;
        
        // 3. è¼‰å…¥ç¬¬ä¸€æ‰¹
        loadNextBatch();
        showScreen('screen-elimination');
    }

    // --- éš¨æ©Ÿä¸€ç™¼ ---
    function startRandom() {
        const luckyItem = db[Math.floor(Math.random() * db.length)];
        renderResult([luckyItem]);
        document.querySelector('#screen-result .subtitle').innerHTML = "å‘½é‹ä¹‹ç¥éš¨ä¾¿æŒ‘äº†ä¸€å€‹çµ¦ä½ ï¼š";
        showScreen('screen-result');
    }

    // --- 4. æ ¼é¬¥å ´èˆ‡æ›æ‰¹åŠŸèƒ½ ---
    function loadNextBatch() {
        const batchSize = 16;
        
        if (poolIndex >= filteredPool.length) {
            if (filteredPool.length === 0) {
                candidates = [];
            } else {
                filteredPool = shuffle(filteredPool);
                poolIndex = 0;
                candidates = filteredPool.slice(poolIndex, poolIndex + batchSize);
                poolIndex += batchSize;
                showToast("åå–®å·²å¾ªç’°ï¼Œé‡æ–°æ´—ç‰Œï¼");
            }
        } else {
            candidates = filteredPool.slice(poolIndex, poolIndex + batchSize);
            poolIndex += batchSize;
        }

        killedIndices.clear(); 
        renderGrid();
        
        document.getElementById('grid-container').scrollTop = 0;
    }

    function renderGrid() {
        const container = document.getElementById('grid-container');
        container.innerHTML = '';

        if (candidates.length === 0) {
            container.innerHTML = '<div style="grid-column: span 2; text-align:center; padding:20px;">æ‰¾ä¸åˆ°ç¬¦åˆçš„é£Ÿç‰©...<br>å¯èƒ½æ¢ä»¶å¤ªåš´è‹›äº†ï¼Œå›ä¸Šä¸€é æ”¾å¯¬ä¸€é»å§ï¼</div>';
            return;
        }

        candidates.forEach((item, index) => {
            const div = document.createElement('div');
            div.className = 'food-item';
            div.innerHTML = `
                <div class="food-emoji">${item.e}</div>
                <div class="food-name">${item.n}</div>
            `;
            div.onclick = () => killFood(index, div);
            container.appendChild(div);
        });
    }

    function killFood(index, element) {
        if (killedIndices.has(index)) {
            killedIndices.delete(index);
            element.classList.remove('killed');
        } else {
            killedIndices.add(index);
            element.classList.add('killed');
        }
    }

    function showFinalResult() {
        const survivors = candidates.filter((_, index) => !killedIndices.has(index));

        if (survivors.length === 0) {
            showToast("å…¨è¢«ä½ æ®ºå…‰äº†ï¼ä½ æ˜¯è¦çµ•é£Ÿå—ï¼ŸğŸ¤£");
            return;
        }

        renderResult(survivors);
        document.querySelector('#screen-result .subtitle').innerHTML = "é€™äº›æ˜¯ä½ åˆ€ä¸‹ç•™äººçš„èè‹± (å…± " + survivors.length + " é …)ï¼š";
        showScreen('screen-result');
    }

    function renderResult(items) {
        const container = document.getElementById('result-content');
        container.innerHTML = '';
        items.forEach(item => {
            const mapUrl = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(item.n)}`;
            container.innerHTML += `
                <div class="result-card">
                    <div style="display:flex; align-items:center;">
                        <span style="font-size:2rem; margin-right:10px;">${item.e}</span>
                        <span style="font-size:1.2rem; font-weight:bold;">${item.n}</span>
                    </div>
                    <a href="${mapUrl}" target="_blank" class="gmap-link">æœåœ°åœ–</a>
                </div>
            `;
        });
    }

    // --- å·¥å…·å‡½å¼ ---
    function showScreen(id) {
        document.querySelectorAll('.card').forEach(c => c.classList.add('hidden'));
        document.getElementById(id).classList.remove('hidden');
    }

    function shuffle(array) {
        let currentIndex = array.length, randomIndex;
        while (currentIndex != 0) {
            randomIndex = Math.floor(Math.random() * currentIndex);
            currentIndex--;
            [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
        }
        return array;
    }

    function showToast(msg) {
        const t = document.getElementById('roast-toast');
        t.innerText = msg;
        t.classList.remove('hidden');
        setTimeout(() => t.classList.add('hidden'), 2000);
    }

</script>

</body>
</html>
