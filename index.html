<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <title>æ™šé¤åƒä»€éº¼ | é¸æ“‡å›°é›£æ•‘æ˜Ÿ</title>
    
    <!-- === SEO æ¨™ç±¤ === -->
    <meta name="description" content="å…¨å°æœ€å¼·æ™šé¤é¸æ“‡å™¨ï¼é‚„åœ¨ç…©æƒ±æ™šé¤åƒä»€éº¼ï¼Ÿåªè¦ 3 ç§’ï¼Œé‡å°ä½ çš„ã€Œé£²é£Ÿç¦å¿Œã€(ä¸åƒç‰›/ç´ é£Ÿ) èˆ‡ã€Œé£¢é¤“å¿ƒæƒ…ã€ï¼Œå¹«ä½ ç”¨ç›´è¦ºæ·˜æ±°æ³•é¸å‡ºä»Šæ™šçš„å‘½å®šç¾é£Ÿã€‚ä¸ç”¨è¨»å†Šï¼Œé¦¬ä¸Šé–‹åƒï¼">
    <meta name="keywords" content="æ™šé¤åƒä»€éº¼, é¸æ“‡å›°é›£, éš¨æ©Ÿæ™šé¤, é™„è¿‘ç¾é£Ÿ, ç´ é£Ÿæ™šé¤, ä¸åƒç‰›, èšé¤æ¨è–¦, æ™šé¤è½‰ç›¤, ç¾é£Ÿè½‰ç›¤, ç¾é£Ÿé¸æ“‡å™¨, æ™šé¤åƒå•¥, è½‰ç›¤">
    <meta name="author" content="Dinner Decider Team">
    
    <!-- Open Graph -->
    <meta property="og:title" content="æ™šé¤åƒä»€éº¼ | é¸æ“‡å›°é›£æ•‘æ˜Ÿ">
    <meta property="og:description" content="åˆ¥å†èªªéš¨ä¾¿äº†ï¼ä¸€éµå¹«ä½ æ±ºå®šä»Šæ™šåƒä»€éº¼ã€‚æ”¯æ´ç´ é£Ÿ/ä¸åƒç‰›ç¯©é¸ï¼Œé‚„æœ‰åˆºæ¿€çš„æ·˜æ±°è³½æ¨¡å¼ï¼">
    <meta property="og:type" content="website">
    
    <!-- GA4 -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-C5JJTP8L35"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-C5JJTP8L35');
    </script>

    <!-- ğŸ“¦ è³‡æ–™æ¨¡çµ„ -->
    <script src="data.js"></script>

    <style>
        :root {
            --primary: #FF9F43;
            --primary-dark: #EE5A24;
            --bg-color: #fdf6e3;
            --card-bg: #ffffff;
            --text-main: #2d3436;
            --text-sub: #636e72;
            --border-color: #FFC312;
            --selected-bg: #ffeaa7;
            --whatever-bg: #dfe6e9;
            --danger-bg: #ff7675;
        }

        body {
            font-family: 'PingFang TC', 'Microsoft JhengHei', sans-serif;
            background: var(--bg-color);
            background-image: radial-gradient(#ffeaa7 15%, transparent 15%), radial-gradient(#ffeaa7 15%, transparent 15%);
            background-size: 24px 24px;
            background-position: 0 0, 12px 12px;
            margin: 0;
            padding: 0;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: var(--text-main);
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        .container {
            width: 100%;
            max-width: 480px;
            padding: 10px;
            box-sizing: border-box;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .card {
            background: var(--card-bg);
            border-radius: 24px;
            box-shadow: 0 8px 32px rgba(255, 159, 67, 0.15);
            border: 2px solid #fff;
            padding: 20px;
            display: flex;
            flex-direction: column;
            flex: 1;
            max-height: 95vh;
            position: relative;
            overflow-y: auto;
            overflow-x: hidden;
            transition: all 0.3s;
        }

        .home-content {
            flex: 1; 
            display: flex; 
            flex-direction: column; 
            justify-content: center; 
            align-items: center;
            padding-bottom: 20px;
        }

        .home-emoji {
            font-size: 3.5rem;
            margin-bottom: 5px;
            animation: bounce 2s infinite;
        }
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {transform: translateY(0);}
            40% {transform: translateY(-10px);}
            60% {transform: translateY(-5px);}
        }

        h1 {
            font-size: 1.5rem;
            margin: 0;
            text-align: center;
            color: var(--text-main);
            font-weight: 900;
            letter-spacing: 1px;
        }

        .subtitle {
            font-size: 0.9rem;
            color: var(--text-sub);
            text-align: center;
            margin-bottom: 15px;
            line-height: 1.4;
        }

        /* é¸é …æŒ‰éˆ•æ¨£å¼ */
        .option-btn {
            background: #fff;
            border: 2px solid #dfe6e9;
            border-radius: 16px;
            padding: 12px;
            text-align: left;
            font-size: 1rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            color: var(--text-main);
            transition: all 0.1s;
            margin-bottom: 8px;
            position: relative;
        }
        .option-btn:active { transform: scale(0.98); }
        
        .option-btn.selected {
            background: var(--selected-bg);
            border-color: var(--primary-dark);
        }
        .option-btn.selected::after {
            content: "âœ…";
            position: absolute;
            right: 15px;
            font-size: 1.2rem;
        }

        /* å¤šé¸é¡Œå°ˆç”¨æ¨£å¼ */
        .option-btn.multi-select.active {
            background: #ffeaa7;
            border-color: var(--primary-dark);
            font-weight: bold;
        }
        .option-btn.multi-select.active::after {
            content: "ğŸš«";
            position: absolute;
            right: 15px;
            font-size: 1.2rem;
        }

        .option-btn.whatever {
            background: var(--whatever-bg);
            border-style: dashed;
            color: var(--text-sub);
        }
        .option-btn.whatever.selected {
            background: #b2bec3;
            color: #fff;
            border-color: var(--text-sub);
        }

        .emoji { font-size: 1.8rem; margin-right: 15px; min-width: 40px; text-align: center; }
        .text-group { display: flex; flex-direction: column; }
        .main-text { font-weight: bold; font-size: 1.05rem; }
        .sub-text { font-size: 0.8rem; opacity: 0.8; margin-top: 4px; }

        .elimination-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            overflow-y: auto;
            padding: 5px;
            flex: 1;
        }

        .food-item {
            background: white;
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: 12px 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 85px;
            user-select: none; /* é˜²æ­¢é•·æŒ‰é¸å–æ–‡å­— */
            -webkit-user-select: none;
        }

        .food-item .food-emoji { font-size: 2rem; margin-bottom: 5px; }
        .food-item .food-name { font-size: 1rem; font-weight: bold; line-height: 1.2; }

        .food-item.killed {
            background: #fab1a0;
            border-color: #fab1a0;
            opacity: 0.5;
            transform: scale(0.9);
            filter: grayscale(0.5);
        }
        .food-item.killed::after {
            content: "âŒ";
            position: absolute;
            font-size: 3rem;
            opacity: 0.8;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .big-btn {
            padding: 14px;
            font-size: 1.05rem;
            border: none;
            background: linear-gradient(135deg, #FF9F43 0%, #EE5A24 100%);
            color: white;
            border-radius: 16px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            box-shadow: 0 4px 15px rgba(238, 90, 36, 0.3);
            margin-bottom: 10px;
            transition: transform 0.1s;
            width: 100%;
        }
        .big-btn:active { transform: scale(0.95); }
        
        .big-btn.secondary {
            background: white;
            border: 2px solid var(--primary);
            color: var(--primary-dark);
            box-shadow: none;
        }

        .big-btn.special-btn {
            background: linear-gradient(135deg, #0984e3 0%, #74b9ff 100%);
            box-shadow: 0 4px 15px rgba(9, 132, 227, 0.3);
        }

        .action-row { display: flex; gap: 10px; margin-top: 10px; }
        .action-row .big-btn { margin-top: 0; flex: 1; font-size: 1rem; padding: 14px; margin-bottom: 0; }

        .category-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            padding: 5px;
        }
        .category-btn {
            background: #fff;
            border: 2px solid #dfe6e9;
            border-radius: 12px;
            padding: 15px 10px;
            text-align: center;
            cursor: pointer;
            font-size: 1rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 5px;
            transition: all 0.2s;
        }
        .category-btn:hover { border-color: var(--primary); color: var(--primary-dark); }
        .category-btn:active { transform: scale(0.98); background: var(--selected-bg); }
        .cat-icon { font-size: 1.8rem; }
        .cat-desc { font-size: 0.75rem; color: var(--text-sub); margin-top: 2px; }

        .result-list { flex: 1; overflow-y: auto; margin: 10px 0; display: flex; flex-direction: column; gap: 10px; }
        .result-card {
            border: 2px solid var(--primary);
            border-radius: 16px;
            padding: 15px;
            background: #fff;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }
        .gmap-link {
            background: #4285F4; color: white; text-decoration: none;
            padding: 10px 15px; border-radius: 10px; font-size: 0.9rem; font-weight: bold;
        }

        .hidden { display: none !important; }
        .nav-header { display: flex; justify-content: space-between; margin-bottom: 10px; }
        .back-text { color: var(--text-sub); font-size: 0.9rem; cursor: pointer; padding: 5px; }

        .roast-toast {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.85);
            color: white;
            padding: 15px 20px;
            border-radius: 12px;
            font-size: 1rem;
            z-index: 10;
            animation: popIn 0.3s;
            text-align: center;
        }
        @keyframes popIn { from {opacity:0; transform: translate(-50%, -40%);} to {opacity:1; transform: translate(-50%, -50%);} }
        
        /* æº«æš–ç³»å…è²¬è²æ˜ */
        .disclaimer-box {
            background: #fdf0e6; 
            border: 1px solid #e0cdb0; 
            border-left: 4px solid #bfa07a; 
            padding: 10px 12px;
            border-radius: 8px;
            margin-top: auto; 
            margin-bottom: 5px;
            font-size: 0.7rem; 
            color: #8d7056; 
            line-height: 1.4;
            text-align: justify; 
        }
        
        .fun-quote {
            font-size: 0.9rem;
            color: var(--primary-dark);
            background: #fff;
            padding: 5px 15px;
            border-radius: 20px;
            margin: 10px auto;
            display: inline-block;
            font-weight: bold;
            border: 1px dashed var(--primary);
        }
    </style>
</head>
<body>

<div class="container">
    
    <!-- 1. é¦–é  -->
    <div id="screen-home" class="card">
        <div class="home-content">
            <div class="home-emoji">ğŸ¤¤</div>
            <h1>æ™šé¤åƒä»€éº¼<br><span style="font-size:1rem; font-weight:normal; background: var(--primary); color: white; padding: 2px 8px; border-radius: 20px;">é¸æ“‡å›°é›£æ•‘æ˜Ÿ</span></h1>
            <p style="color: var(--text-sub); margin-top: 10px; text-align: center; line-height: 1.5; font-size: 0.95rem; max-width: 90%;">
                ä¸å•ä½ æƒ³åƒé£¯é‚„æ˜¯éºµï¼Œ<br>
                åªå•ä½ ä»Šå¤©çš„ã€Œæ„Ÿè¦ºã€å°ä¸å°ã€‚
            </p>
        </div>
        
        <div style="width: 100%;">
            <button class="big-btn" onclick="goToFilter()">
                ğŸ“ å¹«æˆ‘é¸ (å¾æ°£æ°›é–‹å§‹)
            </button>
            
            <button class="big-btn special-btn" onclick="goToCategorySelect()">
                ğŸ¯ æˆ‘å¿ƒè£¡æœ‰æ•¸ (ç›´æ¥é¸èœç³»)
            </button>

            <button class="big-btn secondary" onclick="startRandom()">
                ğŸ² éš¨æ©Ÿä¸€ç™¼
            </button>
        </div>

        <div class="disclaimer-box">
            ğŸ“¢ <strong>è€å¸æ©Ÿå…è²¬ï¼š</strong>
            æœ¬å·¥å…·åªè² è²¬é¸ã€Œåƒä»€éº¼ã€ï¼Œå»å“ªè²·ã€å¤šå°‘éŒ¢ã€æœ‰æ²’æœ‰é–‹ï¼Œè«‹è½‰è·³ Google Maps è‡ªå·±çœ‹ï¼(ä¸è¦è·‘å»å±æ±åƒæ™šé¤å†ä¾†æ€ªæˆ‘ ğŸ¤£)
        </div>
    </div>

    <!-- 2. å¤§æ–¹å‘ç¯©é¸ (Vibe Check) -->
    <div id="screen-filter" class="card hidden">
        <div class="nav-header"><span class="back-text" onclick="goHome()">â¬… å›é¦–é </span></div>
        
        <h1>ä»Šå¤©æ™šé¤ï¼Œåƒé»å¥½çš„</h1>
        <p class="subtitle">å›ç­”é€™å››é¡Œï¼Œç¯©å‡ºä½ æƒ³åƒçš„ã€Œæ°›åœã€</p>

        <div style="flex:1; overflow-y:auto; padding-right: 5px;">
            <!-- Q1 -->
            <div style="margin-bottom: 25px;">
                <p class="main-text">1. ä»Šå¤©æ˜¯ä»€éº¼å±€ï¼Ÿ</p>
                <div class="option-btn" onclick="setFilter('social', 'solo', this)" data-q="social"><span class="emoji">ğŸ§</span><div class="text-group"><span class="main-text">å­¤ç¨ç¾é£Ÿå®¶</span><span class="sub-text">ä¸€äººé£Ÿï¼Œè‡ªåœ¨æœ€é‡è¦ (è§£é–å°åƒ/ä¾¿ç•¶)</span></div></div>
                <div class="option-btn" onclick="setFilter('social', 'group', this)" data-q="social"><span class="emoji">ğŸ»</span><div class="text-group"><span class="main-text">æœ‹å‹/å®¶åº­èšé¤</span><span class="sub-text">éœ€è¦åä¸‹ä¾†å¥½å¥½èŠ (å°æ®ºç”Ÿå­˜é¡é£Ÿç‰©)</span></div></div>
                <div class="option-btn whatever" onclick="setFilter('social', 'any', this)" data-q="social"><span class="emoji">ğŸ¤·â€â™‚ï¸</span><div class="text-group"><span class="main-text">éƒ½å¯ä»¥ / æˆ‘æ˜¯å¤§èƒƒç‹</span><span class="sub-text">æ²’å·®ï¼Œæˆ–æƒ³ä¸€å€‹äººæŒ‘æˆ°å¤šäººé¤ (é€šæ®º)</span></div></div>
            </div>
            <!-- Q2 -->
            <div style="margin-bottom: 25px;">
                <p class="main-text">2. é—œæ–¼ã€Œç½ªæƒ¡æ„Ÿã€é€™ä»¶äº‹...</p>
                <div class="option-btn" onclick="setFilter('health', 'heavy', this)" data-q="health"><span class="emoji">ğŸ˜ˆ</span><div class="text-group"><span class="main-text">å¿«æ¨‚è‡³ä¸Š (é«˜ç†±é‡)</span><span class="sub-text">ç‚¸é›ã€äº”èŠ±è‚‰ã€å…¨ç³–ï¼Œäººç”Ÿè‹¦çŸ­åƒå°±å°äº†ï¼</span></div></div>
                <div class="option-btn" onclick="setFilter('health', 'normal', this)" data-q="health"><span class="emoji">âš–ï¸</span><div class="text-group"><span class="main-text">å‡è¡¡é©ä¸­ (æ¨™æº–)</span><span class="sub-text">æœ‰èœæœ‰è‚‰çš„ä¾¿ç•¶ã€å®šé£Ÿï¼Œåšå€‹æ­£å¸¸äºº</span></div></div>
                <div class="option-btn" onclick="setFilter('health', 'diet', this)" data-q="health"><span class="emoji">ğŸ¥—</span><div class="text-group"><span class="main-text">é‚„å‚µæ™‚åˆ» (æ¸…æ·¡)</span><span class="sub-text">æœ€è¿‘åƒå¤ªå¥½ï¼Œä»Šæ™šæƒ³æ¸…è…¸èƒƒã€åƒè‰</span></div></div>
                <div class="option-btn whatever" onclick="setFilter('health', 'any', this)" data-q="health"><span class="emoji">ğŸ¤·â€â™‚ï¸</span><div class="text-group"><span class="main-text">éƒ½å¯ä»¥</span><span class="sub-text">ç†±é‡ä»€éº¼çš„ï¼Œéš¨é¢¨å»å§</span></div></div>
            </div>
            <!-- Q3 -->
            <div style="margin-bottom: 25px;">
                <p class="main-text">3. å£æ„Ÿç‰©ç†ç‹€æ…‹ï¼Ÿ</p>
                <div class="option-btn" onclick="setFilter('temp', 'hot', this)" data-q="temp"><span class="emoji">â™¨ï¸</span><div class="text-group"><span class="main-text">éˆé­‚é«˜æº«ç‡‰ç…®</span><span class="sub-text">æœ‰æ¹¯æœ‰æ°´ï¼šç«é‹ã€æ¹¯éºµã€ç²¥ã€ç¾¹</span></div></div>
                <div class="option-btn" onclick="setFilter('temp', 'dry', this)" data-q="temp"><span class="emoji">ğŸŒµ</span><div class="text-group"><span class="main-text">ä¹¾çˆ½ç„¡æ¹¯æ´¾</span><span class="sub-text">é£¯é£Ÿã€ä¹¾éºµã€ç‚¸ç‰©ã€çƒ¤ç‰©</span></div></div>
                <div class="option-btn" onclick="setFilter('temp', 'cold', this)" data-q="temp"><span class="emoji">â„ï¸</span><div class="text-group"><span class="main-text">èˆŒå°–é™æº«è¨ˆç•«</span><span class="sub-text">æ¶¼æ‹Œã€ç”Ÿé£Ÿã€æ²™æ‹‰</span></div></div>
                <div class="option-btn whatever" onclick="setFilter('temp', 'any', this)" data-q="temp"><span class="emoji">ğŸ¤·â€â™‚ï¸</span><div class="text-group"><span class="main-text">éƒ½å¯ä»¥</span><span class="sub-text">å†·ç†±ä¸æ‹˜</span></div></div>
            </div>
            <!-- Q4 (Dietary) -->
            <div style="margin-bottom: 25px;">
                <p class="main-text">4. é£²é£Ÿç¦å¿Œ (å¯å¤šé¸ ğŸš«)</p>
                <div class="option-btn multi-select" onclick="toggleDiet('noBeef', this)"><span class="emoji">ğŸ®</span><div class="text-group"><span class="main-text">æˆ‘ä¸åƒç‰›</span><span class="sub-text">æ’é™¤ç‰›è‚‰ã€ç‰›æ¹¯ã€æ¼¢å ¡...</span></div></div>
                <div class="option-btn multi-select" onclick="toggleDiet('noPork', this)"><span class="emoji">ğŸ·</span><div class="text-group"><span class="main-text">æˆ‘ä¸åƒè±¬</span><span class="sub-text">æ’é™¤æ»·è‚‰ã€é¦™è…¸ã€åŸ¹æ ¹...</span></div></div>
                <div class="option-btn multi-select" onclick="toggleDiet('noLamb', this)"><span class="emoji">ğŸ</span><div class="text-group"><span class="main-text">æˆ‘ä¸åƒç¾Š</span><span class="sub-text">æ’é™¤ç¾Šè‚‰çˆã€ç‚’ç¾Šè‚‰...</span></div></div>
                <div class="option-btn multi-select" onclick="toggleDiet('noSeafood', this)"><span class="emoji">ğŸ¦</span><div class="text-group"><span class="main-text">æˆ‘ä¸åƒæµ·é®®</span><span class="sub-text">æ’é™¤é­šã€è¦ã€è›¤èœŠã€é­·é­š...</span></div></div>
                <div class="option-btn multi-select" onclick="toggleDiet('vegetarian', this)"><span class="emoji">ğŸ¥¦</span><div class="text-group"><span class="main-text">æˆ‘åƒç´  (Vegetarian)</span><span class="sub-text">æ’é™¤æ‰€æœ‰è‚‰é¡èˆ‡æµ·é®®</span></div></div>
            </div>
        </div>
        <button class="big-btn" onclick="goToElimination()">ä¸‹ä¸€æ­¥ï¼šçœ‹åå–® â”</button>
    </div>

    <!-- 2.5 èœç³»é¸æ“‡é é¢ -->
    <div id="screen-category" class="card hidden">
        <div class="nav-header"><span class="back-text" onclick="goHome()">â¬… å›é¦–é </span></div>
        
        <h1>ä»Šæ™šæƒ³ç•¶å“ªåœ‹äººï¼Ÿ</h1>
        <p class="subtitle">é¸ä¸€å€‹ä¸»é¡Œï¼Œæˆ‘å€‘ç›´æ¥é€²æ±ºè³½ï¼</p>

        <div style="flex:1; overflow-y:auto;">
            <div class="category-grid">
                <div class="category-btn" onclick="startCategory('tw')">
                    <span class="cat-icon">ğŸ‡¹ğŸ‡¼</span>
                    <span>å°å¼ / åœ¨åœ°</span>
                    <span class="cat-desc">æ»·è‚‰é£¯ã€é¹½é…¥é›ã€ç†±ç‚’</span>
                </div>
                <div class="category-btn" onclick="startCategory('hk')">
                    <span class="cat-icon">ğŸ‡­ğŸ‡°</span>
                    <span>æ¸¯å¼ / ç²µèœ</span>
                    <span class="cat-desc">ç‡’è‡˜ã€é£²èŒ¶ã€ç…²ä»”é£¯</span>
                </div>
                <div class="category-btn" onclick="startCategory('jp')">
                    <span class="cat-icon">ğŸ‡¯ğŸ‡µ</span>
                    <span>æ—¥å¼æ–™ç†</span>
                    <span class="cat-desc">æ‹‰éºµã€å£½å¸ã€ç²¾ç·»æ¾±ç²‰</span>
                </div>
                <div class="category-btn" onclick="startCategory('kr')">
                    <span class="cat-icon">ğŸ‡°ğŸ‡·</span>
                    <span>éŸ“å¼å£å‘³</span>
                    <span class="cat-desc">ç‚¸é›ã€æ³¡èœã€æ­å·´æœ€æ„›</span>
                </div>
                <div class="category-btn" onclick="startCategory('sea')">
                    <span class="cat-icon">ğŸŒ</span>
                    <span>æ±å—äºå¼</span>
                    <span class="cat-desc">æ³°å¼é…¸è¾£ã€è¶Šå¼æ²³ç²‰</span>
                </div>
                <div class="category-btn" onclick="startCategory('it')">
                    <span class="cat-icon">ğŸ‡®ğŸ‡¹</span>
                    <span>ç¾©å¼æ–™ç†</span>
                    <span class="cat-desc">ç¾©å¤§åˆ©éºµã€æŠ«è–©ã€ç‡‰é£¯</span>
                </div>
                <div class="category-btn" onclick="startCategory('us')">
                    <span class="cat-icon">ğŸ‡ºğŸ‡¸</span>
                    <span>æ­ç¾ / è¥¿å¼</span>
                    <span class="cat-desc">æ¼¢å ¡ã€ç‰›æ’ã€è±¬è…³</span>
                </div>
                <div class="category-btn" onclick="startCategory('pot')" style="border-color: #ff7675; background: #fff5f5;">
                    <span class="cat-icon">ğŸ²</span>
                    <span>é‹ç‰©ç¥­</span>
                    <span class="cat-desc">éº»è¾£é‹ã€å°ç«é‹ã€ç¾Šè‚‰çˆ</span>
                </div>
            </div>
        </div>
    </div>

    <!-- 3. æ·˜æ±°æ ¼é¬¥å ´ -->
    <div id="screen-elimination" class="card hidden">
        <div class="nav-header"><span class="back-text" onclick="goHome()">â¬… å›é¦–é  (é‡ä¾†)</span></div>
        
        <h1>ç›´è¦ºæ·˜æ±°è³½</h1>
        <!-- éš±å½¢æŠ€æç¤º -->
        <p class="subtitle">é»æ“Šè¸¢é™¤ <span style="font-size:0.8rem; color:#aaa;">(æ‰‹æ©Ÿé•·æŒ‰/é›»è…¦å³éµå¯ç‚¸æ‰å…¨é¡åˆ¥)</span></p>

        <div id="grid-container" class="elimination-grid">
            <!-- JS ç”Ÿæˆé£Ÿç‰©å¡ç‰‡ -->
        </div>

        <div id="roast-toast" class="roast-toast hidden"></div>

        <div class="action-row">
            <button class="big-btn secondary" onclick="loadNextBatch()">ğŸ”„ å†ä¾†16å€‹</button>
            <button class="big-btn" onclick="showFinalResult()">âœ¨ é€™äº›éƒ½è¡Œï¼</button>
        </div>
    </div>

    <!-- 4. çµæœé  -->
    <div id="screen-result" class="card hidden">
        <div style="text-align: center;">
            <span style="font-size: 3rem;">ğŸ‰</span>
            <h1>å€–å­˜è€…åå–®</h1>
            <!-- æ–°å¢èªéŒ„å€å¡Š -->
            <div id="quote-display" class="fun-quote"></div>
            <p class="subtitle" id="result-subtitle"></p>
        </div>

        <div id="result-content" class="result-list"></div>

        <button class="big-btn secondary" onclick="goHome()" style="margin-top: 10px;">
            ğŸ”„ é‡æ–°ä¸€å±€
        </button>
    </div>

</div>

<script>
    // è€å¸æ©ŸèªéŒ„ (äº’å‹•å½©è›‹)
    const foodieQuotes = [
        "æ¸›è‚¥æ˜¯æ˜å¤©çš„äº‹ï¼Œä»Šå¤©å…ˆåƒé£½å†èªªï¼",
        "é€™å®¶çœ‹èµ·ä¾†å¾ˆå²å®³ï¼Œä¸å»åƒå°ä¸èµ·è‡ªå·±ã€‚",
        "äººç”Ÿè‹¦çŸ­ï¼Œå†çŒ¶è±«åº—å°±è¦é—œäº†ã€‚",
        "åƒé£½æ‰æœ‰åŠ›æ°£æ¸›è‚¥ï¼Œé€™æ˜¯ç§‘å­¸ (æ‡‰è©²å§)ã€‚",
        "è·Ÿè‘—è€å¸æ©Ÿèµ°ï¼Œçµ•ä¸è¸©é›·ï¼",
        "é€™é¤ä¸åƒï¼Œæ™šä¸Šæœƒé¤“åˆ°ç¡ä¸è‘—å–”ã€‚",
        "å°±æ±ºå®šæ˜¯ä½ äº†ï¼å»å§ï¼Œç¥å¥‡å¯¶è²ï¼",
        "ä¸è¦å•ï¼Œåƒå°±å°äº†ã€‚",
        "é›–ç„¶ç†±é‡æœ‰é»é«˜ï¼Œä½†å¿«æ¨‚ç„¡åƒ¹ï¼"
    ];

    // emoji map
    const catMap = {
        tw: { t: "å°å¼", e: "ğŸ‡¹ğŸ‡¼" },
        jp: { t: "æ—¥å¼", e: "ğŸ‡¯ğŸ‡µ" },
        kr: { t: "éŸ“å¼", e: "ğŸ‡°ğŸ‡·" },
        sea: { t: "æ±å—äº", e: "ğŸŒ" },
        us: { t: "æ­ç¾", e: "ğŸ‡ºğŸ‡¸" },
        hk: { t: "æ¸¯å¼", e: "ğŸ‡­ğŸ‡°" },
        it: { t: "ç¾©å¼", e: "ğŸ‡®ğŸ‡¹" },
        pot: { t: "é‹ç‰©", e: "ğŸ²" }
    };

    // --- 2. ç‹€æ…‹ç®¡ç† ---
    let filters = { social: 'solo', health: 'normal', temp: 'hot' }; 
    let dietaryRestrictions = { noBeef: false, noPork: false, noLamb: false, noSeafood: false, vegetarian: false };
    let candidates = [];
    let killedIndices = new Set();
    let filteredPool = [];
    let poolIndex = 0; 

    // --- 3. é é¢è·³è½‰é‚è¼¯ ---
    function goHome() {
        showScreen('screen-home');
    }

    function goToFilter() {
        showScreen('screen-filter');
        
        document.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
        // æ¢å¾©ä¹‹å‰çš„å–®é¸ç‹€æ…‹
        selectBtn('social', filters.social);
        selectBtn('health', filters.health);
        selectBtn('temp', filters.temp);
        
        // æ¢å¾©é£²é£Ÿç¦å¿Œçš„å¤šé¸ç‹€æ…‹
        Object.keys(dietaryRestrictions).forEach(key => {
            const btn = document.querySelector(`.multi-select[onclick*="'${key}'"]`);
            if (dietaryRestrictions[key] && btn) btn.classList.add('active');
            else if (btn) btn.classList.remove('active');
        });
    }

    function goToCategorySelect() {
        showScreen('screen-category');
    }

    function startCategory(catType) {
        // ä½¿ç”¨ window.db ç¢ºä¿è®€å–åˆ° data.js çš„è³‡æ–™
        let matches = db.filter(item => item.c === catType);
        
        // å¥—ç”¨é£²é£Ÿç¦å¿Œéæ¿¾
        matches = matches.filter(checkDietarySafe);
        
        if (matches.length < 4) {
            showToast("é€™å€‹ç¨®é¡ç¬¦åˆæ‚¨é£²é£Ÿç¦å¿Œçš„é¸é …å¤ªå°‘ï¼Œè«‹é¸åˆ¥çš„å§ï¼");
            return;
        }

        filteredPool = shuffle(matches);
        poolIndex = 0;

        loadNextBatch();
        showScreen('screen-elimination');
        showToast("ç›®æ¨™é–å®šï¼è«‹é–‹å§‹ä½ çš„è¡¨æ¼” ğŸ”ª");
    }

    function setFilter(type, val, btn) {
        filters[type] = val;
        const group = document.querySelectorAll(`[data-q="${type}"]`);
        group.forEach(b => b.classList.remove('selected'));
        btn.classList.add('selected');
    }

    function toggleDiet(type, btn) {
        dietaryRestrictions[type] = !dietaryRestrictions[type];
        if (dietaryRestrictions[type]) {
            btn.classList.add('active');
        } else {
            btn.classList.remove('active');
        }
    }

    function selectBtn(type, val) {
        const btn = document.querySelector(`[data-q="${type}"][onclick*="'${val}'"]`);
        if(btn) btn.classList.add('selected');
    }

    // é£²é£Ÿç¦å¿Œæª¢æŸ¥å®˜ (v2.9.6 é‡å¤§å‡ç´š - èœè‰²æ””æˆª)
    function checkDietarySafe(item) {
        const name = item.n;
        
        if (dietaryRestrictions.noBeef) {
            const beefKeywords = ['ç‰›', 'æ¼¢å ¡', 'å¨éˆé “', 'è²»åŸ', 'å£½å–œç‡’', 'ç¾…å®‹', 'æ²³ç²‰'];
            for (let k of beefKeywords) if (name.includes(k)) return false;
        }
        
        if (dietaryRestrictions.noPork) {
            const porkKeywords = [
                'è±¬', 'è±š', 'åŸ¹æ ¹', 'é¦™è…¸', 'è‡˜', 'è‚‰ç‡¥', 'æ»·è‚‰', 'è²¢ä¸¸', 'å‰ç‡’', 'ç«è…¿', 'å¤§è…¸', 'æ§è‚‰', 'æ’éª¨', 'ç™½è‚‰', 'è¹„è†€', 'äº”èŠ±',
                'è‚‰éª¨èŒ¶', 'æ°´é¤ƒ', 'é‹è²¼', 'æŠ„æ‰‹', 'é›²å', 'è‚‰åœ“', 'ç…å­é ­', 'ç‚¸é†¬', 'è’¼è …é ­', 'éƒ¨éšŠé‹', 'æ‹‰éºµ', 'åˆˆåŒ…'
            ];
            for (let k of porkKeywords) if (name.includes(k)) return false;
        }
        
        if (dietaryRestrictions.noLamb) {
            const lambKeywords = ['ç¾Š', 'å­œç„¶'];
            for (let k of lambKeywords) if (name.includes(k)) return false;
        }
        
        if (dietaryRestrictions.noSeafood) {
            const seafoodKeywords = [
                'é­š', 'è¦', 'èŸ¹', 'è›¤', 'æµ·é®®', 'é­·', 'é€æŠ½', 'èšµ', 'è²', 'æ˜å¤ªå­', 'åˆºèº«', 'åœŸé­ ', 'è™±ç›®é­š', 'é¯–é­š', 'é°»', 'é®ª', 'é®­', 'èœ†', 'è ”', 'ç« é­š',
                'å£½å¸', 'å»æ²™', 'é‹ç‡’', 'ç”œä¸è¾£'
            ];
            for (let k of seafoodKeywords) if (name.includes(k)) return false;
        }
        
        if (dietaryRestrictions.vegetarian) {
            if (name.includes('ç´ é£Ÿ') || name.includes('å…¨è”¬èœ')) return true; 
            
            const meatKeywords = [
                'è‚‰', 'é›', 'é´¨', 'éµ', 'è±¬', 'è±š', 'åŸ¹æ ¹', 'é¦™è…¸', 'è‡˜', 'ç‰›', 'ç¾Š', 'ç¦½', 'æ’', 
                'é­š', 'è¦', 'èŸ¹', 'è›¤', 'æµ·é®®', 'é­·', 'èšµ', 'è…¸', 'ä¸¸', 'åˆºèº«', 'è²', 'è ”', 'ç« é­š',
                'æ¼¢å ¡', 'å£½å¸', 'é‹è²¼', 'æ°´é¤ƒ', 'é›²å', 'æŠ„æ‰‹', 'æ¹¯åŒ…', 'è‚‰åœ“', 'éƒ¨éšŠé‹', 'ç…å­é ­', 'ç‚¸é†¬', 'è’¼è …é ­', 'æ‹‰éºµ', 'ç‡’è‡˜', 'é¹½é…¥é›', 'è¦ªå­ä¸¼', 'æ‰“æ‹‹', 'æŠ«è–©'
            ];
            for (let k of meatKeywords) if (name.includes(k)) return false;
        }
        
        return true;
    }

    function goToElimination() {
        // v2.8 Strict Logic
        let safeList = db.filter(checkDietarySafe);

        let initialList = safeList.filter(item => {
            let sMatch = false;
            if (filters.social === 'any') sMatch = true;
            else if (filters.social === 'solo') sMatch = (item.s === 'solo' || item.s === 'any');
            else if (filters.social === 'group') sMatch = (item.s === 'group' || item.s === 'any');

            const healthMatch = (filters.health === 'any') || (item.h === filters.health);
            const tempMatch = (filters.temp === 'any') || (item.t === filters.temp);
            
            return sMatch && healthMatch && tempMatch;
        });
        
        if (initialList.length === 0) {
            showToast("æ‰¾ä¸åˆ°ç¬¦åˆçš„é£Ÿç‰© ğŸ˜… è«‹æ”¾å¯¬æ¢ä»¶è©¦è©¦ï¼");
            return;
        }

        if (initialList.length < 4) {
            showToast(`æ¢ä»¶å¤ªåš´æ ¼ï¼Œåªæ‰¾åˆ° ${initialList.length} å®¶ç¬¦åˆçš„ï¼`);
        }

        filteredPool = shuffle(initialList);
        poolIndex = 0;
        
        loadNextBatch();
        showScreen('screen-elimination');
    }

    function startRandom() {
        let safeList = db.filter(checkDietarySafe);
        if (safeList.length === 0) {
             showToast("ä½ çš„é£²é£Ÿç¦å¿Œå¤ªåš´æ ¼äº†ï¼Œé€£éš¨æ©Ÿéƒ½æ²’æ±è¥¿åƒï¼");
             return;
        }
        const luckyItem = safeList[Math.floor(Math.random() * safeList.length)];
        renderResult([luckyItem]);
        document.querySelector('#screen-result .subtitle').innerHTML = "å‘½é‹ä¹‹ç¥éš¨ä¾¿æŒ‘äº†ä¸€å€‹çµ¦ä½ ï¼š";
        showScreen('screen-result');
    }

    function loadNextBatch() {
        const batchSize = 16;
        
        if (poolIndex >= filteredPool.length) {
            if (filteredPool.length === 0) {
                candidates = [];
            } else {
                filteredPool = shuffle(filteredPool);
                poolIndex = 0;
                candidates = filteredPool.slice(poolIndex, poolIndex + batchSize);
                poolIndex += batchSize;
                showToast("åå–®å·²å¾ªç’°ï¼Œé‡æ–°æ´—ç‰Œï¼");
            }
        } else {
            candidates = filteredPool.slice(poolIndex, poolIndex + batchSize);
            poolIndex += batchSize;
        }

        killedIndices.clear(); 
        renderGrid();
        
        document.getElementById('grid-container').scrollTop = 0;
    }

    function renderGrid() {
        const container = document.getElementById('grid-container');
        container.innerHTML = '';

        if (candidates.length === 0) {
            container.innerHTML = '<div style="grid-column: span 2; text-align:center; padding:20px;">æ‰¾ä¸åˆ°ç¬¦åˆçš„é£Ÿç‰©...<br>å¯èƒ½æ¢ä»¶å¤ªåš´è‹›äº†ï¼Œå›ä¸Šä¸€é æ”¾å¯¬ä¸€é»å§ï¼</div>';
            return;
        }

        candidates.forEach((item, index) => {
            const div = document.createElement('div');
            div.className = 'food-item';
            div.innerHTML = `
                <div class="food-emoji">${item.e}</div>
                <div class="food-name">${item.n}</div>
            `;
            // ä¸€èˆ¬é»æ“Š
            div.onclick = () => killFood(index, div);
            
            // v2.9.8 æ–°å¢ï¼šé•·æŒ‰/å³éµè§¸ç™¼æ ¸å½ˆ (éš±å½¢æŠ€)
            div.oncontextmenu = (e) => {
                e.preventDefault(); // é˜»æ­¢é è¨­å³éµé¸å–®
                if(confirm(`ç¢ºå®šè¦å‰”é™¤æ‰€æœ‰ã€${catMap[item.c].t}ã€‘æ–™ç†å—ï¼Ÿ`)) {
                    nukeCategory(item.c);
                }
            };
            
            container.appendChild(div);
        });
    }

    // éš±å½¢æ ¸å½ˆé‚è¼¯
    function nukeCategory(cCode) {
        const cards = document.querySelectorAll('.food-item');
        candidates.forEach((item, idx) => {
            if (item.c === cCode) {
                if (!killedIndices.has(idx)) {
                    killFood(idx, cards[idx]);
                }
            }
        });
        showToast(`ğŸ’¥ ${catMap[cCode].t}æ–™ç†å·²å…¨éƒ¨å‰”é™¤ï¼`);
    }

    function killFood(index, element) {
        if (killedIndices.has(index)) {
            killedIndices.delete(index);
            element.classList.remove('killed');
        } else {
            killedIndices.add(index);
            element.classList.add('killed');
        }
    }

    function showFinalResult() {
        const survivors = candidates.filter((_, index) => !killedIndices.has(index));

        if (survivors.length === 0) {
            showToast("å…¨è¢«ä½ æ®ºå…‰äº†ï¼ä½ æ˜¯è¦çµ•é£Ÿå—ï¼ŸğŸ¤£");
            return;
        }

        renderResult(survivors);
        document.querySelector('#screen-result .subtitle').innerHTML = "é€™äº›æ˜¯ä½ åˆ€ä¸‹ç•™äººçš„èè‹± (å…± " + survivors.length + " é …)ï¼š";
        showScreen('screen-result');
    }

    function renderResult(items) {
        const container = document.getElementById('result-content');
        container.innerHTML = '';
        
        const randomQuote = foodieQuotes[Math.floor(Math.random() * foodieQuotes.length)];
        const quoteEl = document.getElementById('quote-display');
        if(quoteEl) quoteEl.innerText = randomQuote;

        items.forEach(item => {
            const mapUrl = `https://www.google.com/maps/search/${encodeURIComponent(item.n + " é™„è¿‘")}`;
            container.innerHTML += `
                <div class="result-card">
                    <div style="display:flex; align-items:center;">
                        <span style="font-size:2rem; margin-right:10px;">${item.e}</span>
                        <span style="font-size:1.2rem; font-weight:bold;">${item.n}</span>
                    </div>
                    <a href="${mapUrl}" target="_blank" class="gmap-link">æœåœ°åœ–</a>
                </div>
            `;
        });
    }

    function showScreen(id) {
        document.querySelectorAll('.card').forEach(c => c.classList.add('hidden'));
        document.getElementById(id).classList.remove('hidden');
    }

    function shuffle(array) {
        let currentIndex = array.length, randomIndex;
        while (currentIndex != 0) {
            randomIndex = Math.floor(Math.random() * currentIndex);
            currentIndex--;
            [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
        }
        return array;
    }

    function showToast(msg) {
        const t = document.getElementById('roast-toast');
        t.innerText = msg;
        t.classList.remove('hidden');
        setTimeout(() => t.classList.add('hidden'), 2000);
    }
</script>

</body>
</html>